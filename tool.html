<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Simple BTC Wallet Generator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bip39/3.0.4/bip39.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bitcoinjs-lib/6.1.0/bitcoinjs-lib.min.js"></script>
</head>
<body>
  <h1>Genera Wallet Bitcoin Semplice</h1>

  <button id="generateBtn">Genera Wallet</button>

  <h3>Frase mnemonica (12 parole):</h3>
  <p id="mnemonic"></p>

  <h3>Indirizzo Bitcoin:</h3>
  <p id="address"></p>

  <h3>Chiave privata (WIF):</h3>
  <p id="privateKey"></p>

  <script>
    const NETWORKS = {
      mainnet: bitcoin.networks.bitcoin,
      testnet: bitcoin.networks.testnet
    };

    function generateWallet() {
      // 1. Genera mnemonico 12 parole
      const mnemonic = bip39.generateMnemonic(128);

      // 2. Ottieni seed da mnemonico
      const seed = bip39.mnemonicToSeedSync(mnemonic);

      // 3. Crea root dalla seed (mainnet di default)
      const root = bitcoin.bip32.fromSeed(seed, NETWORKS.mainnet);

      // 4. Deriva percorso standard BIP84 (p2wpkh native segwit)
      const path = "m/84'/0'/0'/0/0";
      const child = root.derivePath(path);

      // 5. Crea indirizzo bitcoin p2wpkh
      const { address } = bitcoin.payments.p2wpkh({ pubkey: child.publicKey, network: NETWORKS.mainnet });

      // 6. Mostra tutto nella pagina
      document.getElementById('mnemonic').textContent = mnemonic;
      document.getElementById('address').textContent = address;
      document.getElementById('privateKey').textContent = child.toWIF();
    }

    document.getElementById('generateBtn').addEventListener('click', generateWallet);
  </script>
</body>
</html>
