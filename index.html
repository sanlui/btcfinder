<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>₿ BTC Finder | Bitcoin Blockchain Explorer | Cerca Indirizzi, Transazioni e Blocchi</title>
  <meta name="description" content="Esplora la blockchain Bitcoin. Cerca indirizzi, transazioni e blocchi. Visualizza saldi, cronologia transazioni e dettagli in tempo reale.">
  <meta name="keywords" content="Bitcoin, BTC, blockchain explorer, explorer Bitcoin, cerca transazioni Bitcoin, cerca indirizzo Bitcoin">
  <meta name="author" content="BTC Finder">
  
  <!-- Open Graph / Social Media Meta Tags -->
  <meta property="og:title" content="₿ BTC Finder - Bitcoin Blockchain Explorer">
  <meta property="og:description" content="Esplora la blockchain Bitcoin. Cerca indirizzi, transazioni e blocchi.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://tuosito.com">
  <meta property="og:image" content="https://tuosito.com/images/btc-finder-preview.png">
  
  <!-- Favicon con simbolo Bitcoin -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>₿</text></svg>">
  
  <!-- Preload dei font -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500&display=swap"></noscript>
  
  <!-- Stili CSS -->
  <style>
    :root {
      --btc-orange: #F7931A; --btc-orange-hover: #E07B0A; --bg-dark: #111; --bg-darker: #0A0A0A;
      --bg-light: #f5f5f5; --text-light: #E5E5E5; --text-dark: #333; --border-gray: #374151;
      --success: #10B981; --warning: #F59E0B; --error: #EF4444;
    }

    *, ::before, ::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Roboto Mono', monospace, system-ui; 
      background: var(--bg-light); 
      color: var(--text-dark); 
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .container {
      width: 100%; 
      max-width: 1200px; 
      margin: 0 auto; 
      padding: 0 1rem;
    }

    /* Header */
    .header {
      position: sticky; 
      top: 0; 
      z-index: 100;
      background: linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-darker) 100%); 
      padding: 1rem 0;
    }

    .header-content {
      display: flex; 
      justify-content: space-between; 
      align-items: center;
    }

    .logo {
      display: flex; 
      align-items: center; 
      gap: 0.75rem;
    }

    .logo h1 {
      color: var(--text-light); 
      font-size: 1.25rem; 
      font-weight: 500; 
      letter-spacing: 0.05em;
    }

    .desktop-nav ul {
      display: flex; 
      gap: 1.5rem; 
      list-style: none;
    }

    .desktop-nav a {
      color: var(--text-light); 
      text-decoration: none; 
      font-size: 0.875rem; 
      font-weight: 500;
      transition: color 0.2s; 
      text-transform: uppercase; 
      letter-spacing: 0.05em; 
      position: relative;
    }

    .desktop-nav a:hover, .desktop-nav a.active { color: var(--btc-orange); }
    .desktop-nav a.active::after {
      content: ''; 
      position: absolute; 
      bottom: -5px; 
      left: 0; 
      width: 100%; 
      height: 2px; 
      background: var(--btc-orange);
    }

    /* Main Content */
    .main-content { 
      padding: 2rem 0;
      flex: 1;
    }

    /* Search Section */
    .search-container {
      background: var(--bg-dark); 
      border-radius: 0.5rem; 
      padding: 1.5rem;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); 
      margin-bottom: 3rem;
    }

    .search-container h2 {
      color: var(--text-light); 
      font-size: 1.125rem; 
      margin-bottom: 1rem; 
      text-transform: uppercase; 
      letter-spacing: 0.05em;
    }

    .search-input-group {
      display: flex; 
      flex-direction: column; 
      gap: 0.75rem;
    }

    #search-type, #search-input {
      background: #1E1E1E; 
      color: var(--text-light); 
      padding: 0.75rem;
      border: 1px solid var(--border-gray); 
      border-radius: 0.375rem; 
      font-family: inherit;
    }

    #search-btn {
      background: var(--btc-orange); 
      color: var(--bg-dark); 
      font-weight: bold; 
      padding: 0.75rem 1.5rem;
      border: none; 
      border-radius: 0.375rem; 
      cursor: pointer; 
      transition: background 0.2s; 
      text-transform: uppercase;
    }

    #search-btn:hover { background: var(--btc-orange-hover); }

    /* Features */
    .features {
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .feature-card {
      background: white; 
      border-radius: 0.5rem; 
      padding: 1.5rem; 
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      transition: transform 0.2s;
    }

    .feature-card:hover {
      transform: translateY(-5px);
    }

    .feature-card h3 {
      color: var(--btc-orange); 
      margin-bottom: 0.75rem;
    }

    /* Stile per i risultati degli indirizzi */
    .address-data-container {
      background: white; 
      border-radius: 0.5rem; 
      padding: 1.5rem;
      margin-top: 1rem; 
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .address-header {
      padding-bottom: 1rem; 
      margin-bottom: 1.5rem; 
      border-bottom: 1px solid #eee;
    }

    .address-hash-display {
      font-family: 'Roboto Mono', monospace; 
      font-size: 1.1rem;
      color: var(--btc-orange); 
      word-break: break-all; 
      margin-bottom: 0.5rem;
    }

    .address-balance-display {
      font-size: 1.5rem; 
      font-weight: bold; 
      color: var(--btc-orange);
      margin: 1rem 0;
    }

    .address-stats-grid {
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem; 
      margin-bottom: 2rem;
    }

    .address-stat-card {
      background: #f9f9f9; 
      border-radius: 0.5rem; 
      padding: 1rem;
    }

    .stat-title {
      font-size: 0.85rem; 
      color: var(--text-dark); 
      opacity: 0.8;
      margin-bottom: 0.5rem; 
      text-transform: uppercase;
    }

    .stat-value {
      font-family: 'Roboto Mono', monospace; 
      font-weight: bold;
    }

    .transactions-section {
      margin-top: 2rem;
    }

    .transactions-header {
      display: flex; 
      justify-content: space-between; 
      align-items: center;
      margin-bottom: 1rem;
    }

    .transaction-list {
      list-style: none;
    }

    .transaction-item {
      padding: 1.25rem 0; 
      border-bottom: 1px solid #eee;
    }

    .tx-hash-link {
      color: var(--btc-orange); 
      text-decoration: none;
      font-family: 'Roboto Mono', monospace; 
      word-break: break-all;
      display: block; 
      margin-bottom: 0.75rem;
    }

    .tx-hash-link:hover {
      text-decoration: underline;
    }

    .tx-details-grid {
      display: grid; 
      grid-template-columns: 1fr 1fr; 
      gap: 1rem;
    }

    .tx-io-box {
      background: #f8f8f8; 
      border-radius: 0.375rem; 
      padding: 0.75rem;
    }

    .tx-address {
      font-family: 'Roboto Mono', monospace; 
      font-size: 0.85rem;
      word-break: break-all; 
      margin-bottom: 0.5rem;
    }

    .tx-amount {
      font-family: 'Roboto Mono', monospace; 
      font-weight: bold;
      color: var(--success);
    }

    .tx-amount.out {
      color: var(--error);
    }

    .tx-confirmations {
      font-size: 0.8rem; 
      color: #666; 
      margin-top: 0.75rem;
    }

    /* Footer */
    .footer {
      background: var(--bg-dark); 
      color: var(--text-light);
      padding: 1.5rem 0; 
      text-align: center;
      margin-top: auto;
    }

    .footer p {
      margin-bottom: 0.5rem; 
      font-size: 0.875rem;
    }

    /* Animazioni */
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .hidden { display: none; }

    /* Loader */
    .loader {
      border: 4px solid #f3f3f3;
      border-top: 4px solid var(--btc-orange);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Schema.org / Rich Snippet */
    .breadcrumb {
      font-size: 0.8rem;
      padding: 0.5rem 0;
      color: #666;
    }

    /* Responsive */
    @media (min-width: 768px) {
      .search-input-group { flex-direction: row; }
    }

    @media (max-width: 768px) {
      .header-content { flex-direction: column; gap: 1rem; }
      .desktop-nav ul { gap: 1rem; }
      .tx-details-grid { grid-template-columns: 1fr; gap: 0.75rem; }
    }
  </style>
  
  <!-- Schema.org markup per Google -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "BTC Finder",
    "description": "Bitcoin Blockchain Explorer per cercare indirizzi, transazioni e blocchi",
    "url": "https://tuosito.com",
    "applicationCategory": "FinanceApplication",
    "operatingSystem": "Web"
  }
  </script>
</head>
<body>
  <header class="header">
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <h1>₿ BTC FINDER</h1>
        </div>
        <nav class="desktop-nav" aria-label="Menu principale">
          <ul>
            <li><a href="index.html" class="nav-link active">HOME</a></li>
            <li><a href="tool.html" class="nav-link">TOOL</a></li>
            <li><a href="api.html" class="nav-link">API</a></li>
            <li><a href="docs.html" class="nav-link">DOCS</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <main class="main-content">
    <div class="container">
      <nav aria-label="Percorso" class="breadcrumb">
        <span>Home</span>
      </nav>
      
      <section class="search-section fade-in">
        <div class="search-container">
          <h1>Bitcoin Blockchain Explorer</h1>
          <form id="search-form" class="search-input-group">
            <select id="search-type" aria-label="Tipo di ricerca">
              <option value="tx">Transaction</option>
              <option value="address" selected>Address</option>
              <option value="block">Block</option>
            </select>
            <input 
              type="text" 
              id="search-input" 
              placeholder="Example: 1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa"
              required
              aria-label="Cerca nella blockchain Bitcoin"
            >
            <button type="submit" id="search-btn" class="btn">Search</button>
          </form>
        </div>
      </section>

      <section class="features fade-in">
        <h2 class="hidden">Features</h2>
        <div class="features">
          <article class="feature-card">
            <h3>Transactions</h3>
            <p>Search by transaction ID with full details</p>
          </article>
          <article class="feature-card">
            <h3>Addresses</h3>
            <p>Track balances and transaction history</p>
          </article>
          <article class="feature-card">
            <h3>Blocks</h3>
            <p>Explore block details and confirmations</p>
          </article>
        </div>
      </section>

      <div id="search-results-container" class="hidden" aria-live="polite">
        <!-- Template per i risultati dell'indirizzo -->
        <div class="address-data-container" id="address-results-template">
          <div class="address-header">
            <h2>Dettagli Indirizzo Bitcoin</h2>
            <div class="address-hash-display" id="address-hash"></div>
            <div class="address-balance-display" id="address-balance"></div>
          </div>

          <div class="address-stats-grid">
            <div class="address-stat-card">
              <div class="stat-title">Transazioni totali</div>
              <div class="stat-value" id="total-transactions"></div>
            </div>
            <div class="address-stat-card">
              <div class="stat-title">BTC ricevuti</div>
              <div class="stat-value" id="total-received"></div>
            </div>
            <div class="address-stat-card">
              <div class="stat-title">BTC inviati</div>
              <div class="stat-value" id="total-sent"></div>
            </div>
            <div class="address-stat-card">
              <div class="stat-title">Saldo finale</div>
              <div class="stat-value" id="final-balance"></div>
            </div>
          </div>

          <div class="transactions-section">
            <div class="transactions-header">
              <h3>Transazioni</h3>
              <div class="stat-title" id="transactions-count"></div>
            </div>

            <ul class="transaction-list" id="transactions-list">
              <!-- Le transazioni verranno aggiunte dinamicamente qui -->
            </ul>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <p>BTC Finder - Open-source Bitcoin blockchain explorer</p>
      <p>MIT License © <span id="current-year"></span></p>
    </div>
  </footer>

  <script>
    // Anno corrente nel footer
    document.getElementById('current-year').textContent = new Date().getFullYear();

    document.getElementById('search-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      const searchType = document.getElementById('search-type').value;
      const searchQuery = document.getElementById('search-input').value.trim();
      
      if (searchQuery) {
        await searchBlockchain(searchType, searchQuery);
      }
    });

    async function searchBlockchain(type, query) {
      const resultsContainer = document.getElementById('search-results-container');
      resultsContainer.innerHTML = '<div class="status-message"><div class="loader"></div><p>Searching blockchain...</p></div>';
      resultsContainer.classList.remove('hidden');

      try {
        // Prima aggiorna l'altezza del blocco corrente
        const currentHeight = await updateCurrentBlockHeight();
        
        if (type === 'address') {
          const data = await fetchAddressData(query);
          displayAddressData(data, currentHeight);
        } else if (type === 'tx') {
          const data = await fetchTransactionData(query);
          displayTransactionData(data);
        } else if (type === 'block') {
          const data = await fetchBlockData(query);
          displayBlockData(data);
        }
      } catch (error) {
        console.error('Error fetching data:', error);
        resultsContainer.innerHTML = `
          <div class="error-message">
            Error: ${error.message || 'Failed to fetch data'}
          </div>
        `;
      }
    }

    async function updateCurrentBlockHeight() {
      try {
        const response = await fetch('https://blockchain.info/q/getblockcount');
        if (!response.ok) throw new Error('Failed to get block height');
        return await response.json();
      } catch (error) {
        console.error("Error updating block height:", error);
        return 814000; // Fallback
      }
    }

    async function fetchAddressData(address) {
      const response = await fetch(`https://blockchain.info/rawaddr/${address}?limit=50`);
      
      if (!response.ok) {
        throw new Error('Address not found or API error');
      }
      
      const data = await response.json();
      
      return {
        address: data.address,
        final_balance: (data.final_balance / 100000000).toFixed(8),
        n_tx: data.n_tx,
        total_received: (data.total_received / 100000000).toFixed(8),
        total_sent: (data.total_sent / 100000000).toFixed(8),
        txs: data.txs.map(tx => ({
          hash: tx.hash,
          block_height: tx.block_height,
          inputs: tx.inputs.map(input => ({
            prev_out: {
              addr: input.prev_out?.addr || 'Coinbase',
              value: (input.prev_out?.value / 100000000).toFixed(8) || '0'
            }
          })),
          out: tx.out.map(output => ({
            addr: output.addr,
            value: (output.value / 100000000).toFixed(8)
          }))
        }))
      };
    }

    async function fetchTransactionData(txHash) {
      const response = await fetch(`https://blockchain.info/rawtx/${txHash}`);
      if (!response.ok) {
        throw new Error('Transaction not found');
      }
      return await response.json();
    }

    async function fetchBlockData(blockHash) {
      const response = await fetch(`https://blockchain.info/rawblock/${blockHash}`);
      if (!response.ok) {
        throw new Error('Block not found');
      }
      return await response.json();
    }

    function displayAddressData(data, currentBlockHeight) {
      const addressResults = document.getElementById('address-results-template').cloneNode(true);
      addressResults.id = '';
      
      // Popola i dati principali
      addressResults.querySelector('#address-hash').textContent = data.address;
      addressResults.querySelector('#address-balance').textContent = `${data.final_balance} BTC`;
      addressResults.querySelector('#total-transactions').textContent = data.n_tx;
      addressResults.querySelector('#total-received').textContent = `${data.total_received} BTC`;
      addressResults.querySelector('#total-sent').textContent = `${data.total_sent} BTC`;
      addressResults.querySelector('#final-balance').textContent = `${data.final_balance} BTC`;
      addressResults.querySelector('#transactions-count').textContent = `${data.txs.length} transazioni`;

      // Popola le transazioni
      const transactionsList = addressResults.querySelector('#transactions-list');
      transactionsList.innerHTML = '';

      data.txs.forEach(tx => {
        const txItem = document.createElement('li');
        txItem.className = 'transaction-item';
        
        txItem.innerHTML = `
          <a href="#${tx.hash}" class="tx-hash-link">${tx.hash}</a>
          <div class="tx-details-grid">
            <div class="tx-io-box">
              <div class="stat-title">Input</div>
              ${tx.inputs.map(input => `
                <div class="tx-address">${input.prev_out.addr}</div>
                <div class="tx-amount out">-${input.prev_out.value} BTC</div>
              `).join('')}
            </div>
            <div class="tx-io-box">
              <div class="stat-title">Output</div>
              ${tx.out.map(output => `
                <div class="tx-address">${output.addr}</div>
                <div class="tx-amount">+${output.value} BTC</div>
              `).join('')}
            </div>
          </div>
          <div class="tx-confirmations">${tx.block_height ? (currentBlockHeight - tx.block_height + 1) + ' conferme' : 'Non confermato'}</div>
        `;
        
        transactionsList.appendChild(txItem);
      });

      // Sostituisci il contenuto del container dei risultati
      const resultsContainer = document.getElementById('search-results-container');
      resultsContainer.innerHTML = '';
      resultsContainer.appendChild(addressResults);
      resultsContainer.classList.remove('hidden');
    }

    function displayTransactionData(data) {
      const resultsContainer = document.getElementById('search-results-container');
      resultsContainer.innerHTML = `
        <div class="address-data-container">
          <div class="address-header">
            <h2>Transaction Details</h2>
            <div class="address-hash-display">${data.hash}</div>
          </div>
          
          <div class="address-stats-grid">
            <div class="address-stat-card">
              <div class="stat-title">Block Height</div>
              <div class="stat-value">${data.block_height || 'Unconfirmed'}</div>
            </div>
            <div class="address-stat-card">
              <div class="stat-title">Size</div>
              <div class="stat-value">${data.size} bytes</div>
            </div>
            <div class="address-stat-card">
              <div class="stat-title">Fee</div>
              <div class="stat-value">${(data.fee / 100000000).toFixed(8)} BTC</div>
            </div>
          </div>
          
          <div class="transactions-section">
            <h3>Transaction I/O</h3>
            <div class="tx-details-grid">
              <div class="tx-io-box">
                <h4>Inputs (${data.inputs.length})</h4>
                ${data.inputs.map(input => `
                  <div class="tx-address">${input.prev_out?.addr || 'Coinbase'}</div>
                  <div class="tx-amount out">${input.prev_out ? (input.prev_out.value / 100000000).toFixed(8) + ' BTC' : 'Coinbase'}</div>
                `).join('')}
              </div>
              <div class="tx-io-box">
                <h4>Outputs (${data.out.length})</h4>
                ${data.out.map(output => `
                  <div class="tx-address">${output.addr}</div>
                  <div class="tx-amount">${(output.value / 100000000).toFixed(8)} BTC</div>
                `).join('')}
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function displayBlockData(data) {
      const resultsContainer = document.getElementById('search-results-container');
      resultsContainer.innerHTML = `
        <div class="address-data-container">
          <div class="address-header">
            <h2>Block Details</h2>
            <div class="address-hash-display">${data.hash}</div>
          </div>
          
          <div class="address-stats-grid">
            <div class="address-stat-card">
              <div class="stat-title">Height</div>
              <div class="stat-value">${data.height}</div>
            </div>
            <div class="address-stat-card">
              <div class="stat-title">Timestamp</div>
              <div class="stat-value">${new Date(data.time * 1000).toLocaleString()}</div>
            </div>
            <div class="address-stat-card">
              <div class="stat-title">Transactions</div>
              <div class="stat-value">${data.n_tx}</div>
            </div>
            <div class="address-stat-card">
              <div class="stat-title">Size</div>
              <div class="stat-value">${data.size} bytes</div>
            </div>
          </div>
          
          <div class="transactions-section">
            <h3>Block Transactions</h3>
            <ul class="transaction-list">
              ${data.tx.slice(0, 20).map(tx => `
                <li class="transaction-item">
                  <a href="#${tx.hash}" class="tx-hash-link">${tx.hash}</a>
                </li>
              `).join('')}
              ${data.tx.length > 20 ? `<li>... and ${data.tx.length - 20} more transactions</li>` : ''}
            </ul>
          </div>
        </div>
      `;
    }
  </script>
</body>
</html>
